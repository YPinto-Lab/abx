SHOW COLUMNS IN sra.tax_analysis;
acc                 
tax_id              
rank                
name                
total_count         
self_count          
ilevel              
ileft               
iright 



SHOW COLUMNS IN sra.metadata;
acc                 
assay_type          
center_name         
consent             
experiment          
sample_name         
instrument          
librarylayout       
libraryselection    
librarysource       
platform            
sample_acc          
biosample           
organism            
sra_study           
releasedate         
bioproject          
mbytes              
loaddate            
avgspotlen          
mbases              
insertsize          
library_name        
biosamplemodel_sam  
collection_date_sam 
geo_loc_name_country_calc
geo_loc_name_country_continent_calc
geo_loc_name_sam    
ena_first_public_run
ena_last_update_run 
sample_name_sam     
datastore_filetype  
datastore_provider  
datastore_region    
attributes          
jattr               
run_file_version    








CREATE TABLE sra.prjna974858
WITH (
  format = 'PARQUET',
  external_location = 's3://yarin-athena-results/projects/prjna974858/'
) AS
SELECT
    -- עמודות מ tax_analysis
    TAX.acc,
    TAX.tax_id,
    TAX.rank,
    TAX.name,
    TAX.total_count,
    TAX.self_count,
    TAX.ilevel,
    TAX.ileft,
    TAX.iright,

    -- עמודות מ metadata — בלי עמודת acc (שכבר לקחנו)
    M.assay_type,
    M.center_name,
    M.consent,
    M.experiment,
    M.sample_name,
    M.instrument,
    M.librarylayout,
    M.libraryselection,
    M.librarysource,
    M.platform,
    M.sample_acc,
    M.biosample,
    M.organism,
    M.sra_study,
    M.releasedate,
    M.bioproject,
    M.mbytes,
    M.loaddate,
    M.avgspotlen,
    M.mbases,
    M.insertsize,
    M.library_name,
    M.biosamplemodel_sam,
    M.collection_date_sam,
    M.geo_loc_name_country_calc,
    M.geo_loc_name_country_continent_calc,
    M.geo_loc_name_sam,
    M.ena_first_public_run,
    M.ena_last_update_run,
    M.sample_name_sam,
    M.datastore_filetype,
    M.datastore_provider,
    M.datastore_region,
    M.attributes,
    M.jattr,
    M.run_file_version

FROM sra.tax_analysis  AS TAX
JOIN sra.metadata      AS M
    ON TAX.acc = M.acc
WHERE M.bioproject = 'PRJNA974858';

